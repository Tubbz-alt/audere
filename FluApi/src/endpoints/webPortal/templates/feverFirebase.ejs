<!--
Copyright (c) 2019 by Audere

Use of this source code is governed by an MIT-style license that
can be found in the LICENSE file distributed with this file.
-->

<html>
  <head>
    <title>flu@home Firebase</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="<%= static %>/css/metrics.css"/>
    <link rel="icon" type="image/x-icon" href="<%= static %>/favicon-32x32.png" />
  </head>
  <body>
    <%
    function getLastMonday() {
      var t = new Date();
      t.setDate(t.getDate() - t.getDay() + 1);
      return t.toISOString().slice(0, 10);
    }
    function getThisSunday() {
      var t = new Date();
      t.setDate(t.getDate() - t.getDay() + 7);
      return t.toISOString().slice(0, 10);
    }
    function getToday() {
      var t = new Date();
      t.setDate(t.getDate());
      return t.toISOString().slice(0, 10);
    }
    %>
    <form action="./feverFirebase" method="get">
      <table id="date-form">
        <tr>
          <td>Show data from</td>
          <td>
            <input name="startDate" type="text" value="<%= startDate %>" />
          </td>
          <td>to</td>
          <td><input name="endDate" type="text" value="<%= endDate %>" /></td>
          <td><button type="submit">Go</button></td>
          <td><input type="button" onClick="location.href='/portal/feverFirebase?startDate=<%=getToday()%>&amp;endDate=<%=getToday()%>';"value="Today"></td>
          <td><input type="button" onClick="location.href='/portal/feverFirebase?startDate=<%=getLastMonday()%>&amp;endDate=<%=getThisSunday()%>';" value="This Week"></td>
        </tr>
      </table>
    </form>
    <br />
    <br />
    <h2>flu@home Ad Referrals</h2>
    <table class="hor-zebra">
      <thead>
        <tr>
          <th><label title="Ad content summary">Ad</label></th>
          <th><label title="Number of app installs for the ad">Number of Installs</label></th>
        </tr>
      </thead>
      <tbody>
        <% oddRow = true;
            adReferralData.forEach(function(row) {
           if (row.age === "Total") {
         %>
       <tr class="sum">
         <% } else if (oddRow) { %>
       <tr class="odd">
         <% } else { %>
       <tr>
         <% } %>
          <td><%= row.ad %></td>
          <td><%= row.count %></td>
        </tr>
        <% oddRow = !oddRow;
          }); %>
        </tr>
      </tbody>
  </body>
</html>
