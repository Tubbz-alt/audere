{
    "Ad Referrals": [
      "SELECT (SELECT value.string_value FROM UNNEST(user_properties) WHERE key='utm_content') AS Ad, ",
        "COUNT(DISTINCT user_id) AS Count ",
      "FROM `flu-at-home-app.analytics_195485168.no_demo_events_*` ",
      "WHERE EXISTS (SELECT 1 FROM UNNEST(user_properties) WHERE key='install_referrer') AND ",
        "TIMESTAMP_MICROS(user_first_touch_timestamp) BETWEEN ? AND ? ",
      "GROUP BY Ad ",
      "HAVING Ad IS NOT NULL ",
      "ORDER by Count DESC "
    ],
    "Engagement Time by Screen": [
      "SELECT (SELECT value.string_value FROM UNNEST(event_params) WHERE key='firebase_screen') as Screen, ",
        "ROUND(SUM((SELECT value.int_value/1000 FROM UNNEST(event_params) WHERE ",
          "key='engagement_time_msec'))/COUNT(DISTINCT user_id), 1) AS Average_Time_Spent_In_Seconds ",
      "FROM `flu-at-home-app.analytics_195485168.no_demo_events_*` ",
      "WHERE event_name = 'user_engagement' AND ",
        "(SELECT value.int_value/1000 FROM UNNEST(event_params) WHERE key='engagement_time_msec') < 700 AND ",
        "TIMESTAMP_MICROS(user_first_touch_timestamp) BETWEEN ? AND ? ",
      "GROUP BY Screen ",
      "HAVING Screen IS NOT NULL ",
      "ORDER BY Average_Time_Spent_In_Seconds DESC "
    ],
    "Funnel Events": [
      "SELECT event_name AS Event, COUNT(DISTINCT user_pseudo_id) AS Users ",
      "FROM `flu-at-home-app.analytics_195485168.no_demo_events_*` ",
      "WHERE event_name IN ('funnel_met_symptoms', ",
        "'funnel_consent_completed', ",
        "'funnel_address_completed', ",
        "'funnel_scan_confirmation', ",
        "'funnel_completed_survey', ",
        "'funnel_completed_shipping') AND ",
        "TIMESTAMP_MICROS(user_first_touch_timestamp) BETWEEN ? AND ? ",
      "GROUP BY Event ",
      "ORDER BY Users DESC "
    ]
}